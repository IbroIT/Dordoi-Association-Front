import React, { useRef, useState, useEffect } from 'react';
import { motion, useInView, AnimatePresence } from 'framer-motion';
import { useTranslation } from 'react-i18next';
import { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';
import L from 'leaflet';
import 'leaflet/dist/leaflet.css';

// Fix for default markers in react-leaflet
delete L.Icon.Default.prototype._getIconUrl;
L.Icon.Default.mergeOptions({
  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',
  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',
  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',
});

// Custom markers for different partner types
const createCustomMarker = (type) => {
  const colors = {
    clinical: '#dc2626',
    university: '#2563eb',
    organization: '#16a34a',
    business: '#9333ea',
    academic: '#6b7280',
    medical: '#dc2626',
    educational: '#2563eb',
    research: '#16a34a',
    corporate: '#9333ea'
  };

  const icons = {
    clinical: 'üè•',
    university: 'üéì',
    organization: 'üî¨',
    business: 'üíº',
    academic: 'üìö',
    medical: 'üè•',
    educational: 'üéì',
    research: 'üî¨',
    corporate: 'üíº'
  };

  return new L.DivIcon({
    className: 'custom-marker',
    html: `<div style="
      background-color: ${colors[type] || '#6b7280'};
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: 3px solid white;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 16px;
      transition: all 0.3s ease;
    ">${icons[type] || 'ü§ù'}</div>`,
    iconSize: [36, 36],
    iconAnchor: [18, 18],
    popupAnchor: [0, -18]
  });
};

// Custom marker for our locations
const createLocationMarker = (type) => {
  const colors = {
    office: '#dc2626',
    warehouse: '#059669',
    'trade-complex': '#7c3aed',
    headquarter: '#dc2626',
    storage: '#059669',
    commercial: '#7c3aed'
  };

  const icons = {
    office: 'üè¢',
    warehouse: 'üè≠',
    'trade-complex': 'üè™',
    headquarter: 'üè¢',
    storage: 'üè≠',
    commercial: 'üè™'
  };

  return new L.DivIcon({
    className: 'location-marker',
    html: `<div style="
      background-color: ${colors[type] || '#2563eb'};
      width: 42px;
      height: 42px;
      border-radius: 50%;
      border: 3px solid white;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 18px;
      transition: all 0.3s ease;
    ">${icons[type] || 'üìç'}</div>`,
    iconSize: [42, 42],
    iconAnchor: [21, 21],
    popupAnchor: [0, -21]
  });
};

const ContactsAddress = () => {
  const ref = useRef(null);
  const isInView = useInView(ref, { once: true, threshold: 0.1 });
  const { t, i18n } = useTranslation();
  const [activeContact, setActiveContact] = useState(null);
  const [copiedField, setCopiedField] = useState(null);
  const [partners, setPartners] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [mapType, setMapType] = useState('locations');
  const [selectedPartner, setSelectedPartner] = useState(null);
  const [selectedLocation, setSelectedLocation] = useState(null);
  const [activeFilter, setActiveFilter] = useState('all');
  const [searchQuery, setSearchQuery] = useState('');

  // Mock partners data - in real app this would come from API
  useEffect(() => {
    const fetchPartners = async () => {
      try {
        setLoading(true);
        // Simulate API call
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        const mockPartners = [
          {
            id: 1,
            name: t('contacts.partners.list.0.name', { defaultValue: '–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ—Å–ø–∏—Ç–∞–ª—å' }),
            type: 'clinical',
            country: t('contacts.partners.list.0.country', { defaultValue: '–ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω' }),
            city: t('contacts.partners.list.0.city', { defaultValue: '–ë–∏—à–∫–µ–∫' }),
            description: t('contacts.partners.list.0.description', { defaultValue: '–í–µ–¥—É—â–µ–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã' }),
            website: 'https://hospital.kg',
            email: 'info@hospital.kg',
            phone: '+996 (312) 111-111',
            address: t('contacts.partners.list.0.address', { defaultValue: '–≥. –ë–∏—à–∫–µ–∫, —É–ª. –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è, 1' }),
            logo: '/api/placeholder/100/100',
            coordinates: [42.8746, 74.5698],
            established: '1995',
            cooperation_since: '2010',
            cooperation: [
              t('contacts.partners.list.0.cooperation.0', { defaultValue: '–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è' }),
              t('contacts.partners.list.0.cooperation.1', { defaultValue: '–û–±—É—á–µ–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤' }),
              t('contacts.partners.list.0.cooperation.2', { defaultValue: '–ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è' })
            ],
            contact: {
              email: 'info@hospital.kg',
              phone: '+996 (312) 111-111'
            }
          },
          {
            id: 2,
            name: t('contacts.partners.list.1.name', { defaultValue: '–ö—ã—Ä–≥—ã–∑—Å–∫–∏–π –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç' }),
            type: 'university',
            country: t('contacts.partners.list.1.country', { defaultValue: '–ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω' }),
            city: t('contacts.partners.list.1.city', { defaultValue: '–ë–∏—à–∫–µ–∫' }),
            description: t('contacts.partners.list.1.description', { defaultValue: '–ö—Ä—É–ø–Ω–µ–π—à–∏–π –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ü–µ–Ω—Ç—Ä' }),
            website: 'https://university.kg',
            email: 'contact@university.kg',
            phone: '+996 (312) 222-222',
            address: t('contacts.partners.list.1.address', { defaultValue: '–≥. –ë–∏—à–∫–µ–∫, —É–ª. –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—Å–∫–∞—è, 5' }),
            logo: '/api/placeholder/100/100',
            coordinates: [42.8846, 74.5798],
            established: '1951',
            cooperation_since: '2015',
            cooperation: [
              t('contacts.partners.list.1.cooperation.0', { defaultValue: '–ù–∞—É—á–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è' }),
              t('contacts.partners.list.1.cooperation.1', { defaultValue: '–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã' }),
              t('contacts.partners.list.1.cooperation.2', { defaultValue: '–°—Ç–∞–∂–∏—Ä–æ–≤–∫–∏' })
            ],
            contact: {
              email: 'contact@university.kg',
              phone: '+996 (312) 222-222'
            }
          },
          {
            id: 3,
            name: t('contacts.partners.list.2.name', { defaultValue: '–ù–∞—É—á–Ω–æ-–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Å—Ç–∏—Ç—É—Ç' }),
            type: 'research',
            country: t('contacts.partners.list.2.country', { defaultValue: '–ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω' }),
            city: t('contacts.partners.list.2.city', { defaultValue: '–ë–∏—à–∫–µ–∫' }),
            description: t('contacts.partners.list.2.description', { defaultValue: '–ü–µ—Ä–µ–¥–æ–≤–æ–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä' }),
            website: 'https://research.kg',
            email: 'research@institute.kg',
            phone: '+996 (312) 333-333',
            address: t('contacts.partners.list.2.address', { defaultValue: '–≥. –ë–∏—à–∫–µ–∫, —É–ª. –ù–∞—É—á–Ω–∞—è, 10' }),
            logo: '/api/placeholder/100/100',
            coordinates: [42.8646, 74.5598],
            established: '1980',
            cooperation_since: '2018',
            cooperation: [
              t('contacts.partners.list.2.cooperation.0', { defaultValue: '–ò–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã' }),
              t('contacts.partners.list.2.cooperation.1', { defaultValue: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏' })
            ],
            contact: {
              email: 'research@institute.kg',
              phone: '+996 (312) 333-333'
            }
          }
        ];
        
        setPartners(mockPartners);
      } catch (err) {
        setError(t('contacts.partners.error', { defaultValue: '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤' }));
        console.error('Error fetching partners:', err);
      } finally {
        setLoading(false);
      }
    };

    fetchPartners();
  }, [i18n.language, t]);

  const contactInfo = {
    address: {
      title: t('contacts.address.title'),
      value: t('contacts.address.value'),
      icon: 'üìç',
      description: t('contacts.address.description'),
      coordinates: [42.8746, 74.5698],
      details: t('contacts.address.details', { defaultValue: '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –æ—Ñ–∏—Å —Å –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü-–∑–∞–ª–∞–º–∏ –∏ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω—ã–º–∏ –∫–æ–º–Ω–∞—Ç–∞–º–∏' })
    },
    phones: [
      {
        title: t('contacts.phones.general.title'),
        number: t('contacts.phones.general.number'),
        icon: 'üìû',
        description: t('contacts.phones.general.description'),
        department: t('contacts.phones.general.department', { defaultValue: '–û–±—â–∏–π –æ—Ç–¥–µ–ª' })
      },
      {
        title: t('contacts.phones.reception.title'),
        number: t('contacts.phones.reception.number'),
        icon: 'üè¢',
        description: t('contacts.phones.reception.description'),
        department: t('contacts.phones.reception.department', { defaultValue: '–ü—Ä–∏–µ–º–Ω–∞—è' })
      },
      {
        title: t('contacts.phones.press.title'),
        number: t('contacts.phones.press.number'),
        icon: 'üì∞',
        description: t('contacts.phones.press.description'),
        department: t('contacts.phones.press.department', { defaultValue: '–ü—Ä–µ—Å—Å-—Å–ª—É–∂–±–∞' })
      },
      {
        title: t('contacts.phones.partnership.title'),
        number: t('contacts.phones.partnership.number'),
        icon: 'ü§ù',
        description: t('contacts.phones.partnership.description'),
        department: t('contacts.phones.partnership.department', { defaultValue: '–û—Ç–¥–µ–ª –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤' })
      }
    ],
    emails: [
      {
        title: t('contacts.emails.info.title'),
        address: t('contacts.emails.info.address'),
        icon: 'üìß',
        description: t('contacts.emails.info.description'),
        response: t('contacts.emails.info.response', { defaultValue: '–û—Ç–≤–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤' })
      },
      {
        title: t('contacts.emails.press.title'),
        address: t('contacts.emails.press.address'),
        icon: 'üì∞',
        description: t('contacts.emails.press.description'),
        response: t('contacts.emails.press.response', { defaultValue: '–û—Ç–≤–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 2 —á–∞—Å–æ–≤' })
      },
      {
        title: t('contacts.emails.partnership.title'),
        address: t('contacts.emails.partnership.address'),
        icon: 'ü§ù',
        description: t('contacts.emails.partnership.description'),
        response: t('contacts.emails.partnership.response', { defaultValue: '–û—Ç–≤–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 48 —á–∞—Å–æ–≤' })
      }
    ],
    hours: {
      title: t('contacts.hours.title'),
      schedule: [
        { 
          days: t('contacts.hours.weekdays.days'), 
          time: t('contacts.hours.weekdays.time'),
          note: t('contacts.hours.weekdays.note', { defaultValue: '–û–±–µ–¥ 13:00-14:00' })
        },
        { 
          days: t('contacts.hours.weekends.days'), 
          time: t('contacts.hours.weekends.time'),
          note: t('contacts.hours.weekends.note', { defaultValue: '–ü–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞–ø–∏—Å–∏' })
        },
        { 
          days: t('contacts.hours.holidays.days'), 
          time: t('contacts.hours.holidays.time'),
          note: t('contacts.hours.holidays.note', { defaultValue: '–≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã' })
        }
      ],
      icon: 'üïí',
      notice: t('contacts.hours.notice', { defaultValue: '–í—Ä–µ–º—è —É–∫–∞–∑–∞–Ω–æ –¥–ª—è –º–µ—Å—Ç–Ω–æ–≥–æ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞' })
    },
    social: {
      title: t('contacts.social.title', { defaultValue: '–ú—ã –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö' }),
      platforms: [
        {
          name: 'Facebook',
          icon: 'üìò',
          url: 'https://facebook.com/dordoi',
          handle: t('contacts.social.facebook.handle', { defaultValue: '@dordoi' })
        },
        {
          name: 'Instagram',
          icon: 'üì∑',
          url: 'https://instagram.com/dordoi',
          handle: t('contacts.social.instagram.handle', { defaultValue: '@dordoi' })
        },
        {
          name: 'Telegram',
          icon: 'üì¢',
          url: 'https://t.me/dordoi',
          handle: t('contacts.social.telegram.handle', { defaultValue: '@dordoi' })
        },
        {
          name: 'YouTube',
          icon: 'üé•',
          url: 'https://youtube.com/dordoi',
          handle: t('contacts.social.youtube.handle', { defaultValue: '–î–æ—Ä–¥–æ–π' })
        }
      ]
    }
  };

  const mapLocations = [
    {
      id: 'office',
      title: t('contacts.map.locations.office.title'),
      description: t('contacts.map.locations.office.description'),
      coordinates: [42.8746, 74.5698],
      type: 'office',
      details: t('contacts.map.locations.office.details', { defaultValue: '5-—ç—Ç–∞–∂–Ω–æ–µ –∑–¥–∞–Ω–∏–µ —Å –ø–∞—Ä–∫–æ–≤–∫–æ–π –∏ –æ—Ö—Ä–∞–Ω–æ–π' }),
      amenities: [
        t('contacts.map.locations.office.amenities.0', { defaultValue: '–ü–∞—Ä–∫–æ–≤–∫–∞' }),
        t('contacts.map.locations.office.amenities.1', { defaultValue: '–ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü-–∑–∞–ª—ã' }),
        t('contacts.map.locations.office.amenities.2', { defaultValue: '–ö–∞—Ñ–µ' })
      ]
    },
    {
      id: 'trade-complex',
      title: t('contacts.map.locations.tradeComplex.title'),
      description: t('contacts.map.locations.tradeComplex.description'),
      coordinates: [42.8846, 74.5798],
      type: 'commercial',
      details: t('contacts.map.locations.tradeComplex.details', { defaultValue: '–ö—Ä—É–ø–Ω–µ–π—à–∏–π —Ç–æ—Ä–≥–æ–≤—ã–π –∫–æ–º–ø–ª–µ–∫—Å –≤ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ê–∑–∏–∏' }),
      amenities: [
        t('contacts.map.locations.tradeComplex.amenities.0', { defaultValue: '5000+ –º–∞–≥–∞–∑–∏–Ω–æ–≤' }),
        t('contacts.map.locations.tradeComplex.amenities.1', { defaultValue: '–†–µ—Å—Ç–æ—Ä–∞–Ω—ã' }),
        t('contacts.map.locations.tradeComplex.amenities.2', { defaultValue: '–ë–∞–Ω–∫–∏' })
      ]
    },
    {
      id: 'warehouse',
      title: t('contacts.map.locations.warehouse.title'),
      description: t('contacts.map.locations.warehouse.description'),
      coordinates: [42.8646, 74.5598],
      type: 'storage',
      details: t('contacts.map.locations.warehouse.details', { defaultValue: '–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∫–ª–∞–¥—Å–∫–æ–π –∫–æ–º–ø–ª–µ–∫—Å —Å –∫–ª–∏–º–∞—Ç-–∫–æ–Ω—Ç—Ä–æ–ª–µ–º' }),
      amenities: [
        t('contacts.map.locations.warehouse.amenities.0', { defaultValue: '–ö–ª–∏–º–∞—Ç-–∫–æ–Ω—Ç—Ä–æ–ª—å' }),
        t('contacts.map.locations.warehouse.amenities.1', { defaultValue: '–û—Ö—Ä–∞–Ω–∞ 24/7' }),
        t('contacts.map.locations.warehouse.amenities.2', { defaultValue: '–ü–æ–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ä–∞–º–ø—ã' })
      ]
    }
  ];

  const containerVariants = {
    hidden: { opacity: 0 },
    visible: {
      opacity: 1,
      transition: {
        staggerChildren: 0.1
      }
    }
  };

  const itemVariants = {
    hidden: { y: 30, opacity: 0 },
    visible: {
      y: 0,
      opacity: 1,
      transition: {
        duration: 0.7,
        ease: [0.25, 0.46, 0.45, 0.94]
      }
    }
  };

  const cardVariants = {
    hidden: { scale: 0.95, opacity: 0, y: 20 },
    visible: {
      scale: 1,
      opacity: 1,
      y: 0,
      transition: {
        duration: 0.6,
        ease: "easeOut"
      }
    },
    hover: {
      y: -8,
      scale: 1.02,
      transition: {
        duration: 0.3,
        ease: "easeInOut"
      }
    }
  };

  const floatingVariants = {
    animate: {
      y: [0, -20, 0],
      x: [0, 10, 0],
      transition: {
        duration: 6,
        repeat: Infinity,
        ease: "easeInOut"
      }
    }
  };

  const copyToClipboard = async (text, field) => {
    try {
      await navigator.clipboard.writeText(text);
      setCopiedField(field);
      setTimeout(() => setCopiedField(null), 2000);
    } catch (err) {
      console.error('Failed to copy text: ', err);
    }
  };

  const getTypeBadgeColor = (type) => {
    const colors = {
      clinical: 'bg-red-100 text-red-800 border-red-200',
      university: 'bg-blue-100 text-blue-800 border-blue-200',
      organization: 'bg-green-100 text-green-800 border-green-200',
      business: 'bg-purple-100 text-purple-800 border-purple-200',
      academic: 'bg-gray-100 text-gray-800 border-gray-200',
      research: 'bg-emerald-100 text-emerald-800 border-emerald-200',
      medical: 'bg-red-100 text-red-800 border-red-200',
      educational: 'bg-blue-100 text-blue-800 border-blue-200',
      corporate: 'bg-purple-100 text-purple-800 border-purple-200'
    };
    return colors[type] || 'bg-gray-100 text-gray-800 border-gray-200';
  };

  const getTypeLabel = (type) => {
    const typeLabels = {
      'clinical': t('contacts.partners.types.clinical', { defaultValue: '–ö–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –±–∞–∑–∞' }),
      'university': t('contacts.partners.types.university', { defaultValue: '–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç' }),
      'organization': t('contacts.partners.types.organization', { defaultValue: '–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è' }),
      'business': t('contacts.partners.types.business', { defaultValue: '–ë–∏–∑–Ω–µ—Å-–ø–∞—Ä—Ç–Ω–µ—Ä' }),
      'academic': t('contacts.partners.types.academic', { defaultValue: '–ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Ç–Ω–µ—Ä' }),
      'research': t('contacts.partners.types.research', { defaultValue: '–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä' }),
      'medical': t('contacts.partners.types.medical', { defaultValue: '–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ' }),
      'educational': t('contacts.partners.types.educational', { defaultValue: '–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ' }),
      'corporate': t('contacts.partners.types.corporate', { defaultValue: '–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–∞—Ä—Ç–Ω–µ—Ä' })
    };
    return typeLabels[type] || t('contacts.partners.types.general', { defaultValue: '–ü–∞—Ä—Ç–Ω–µ—Ä' });
  };

  const partnerTypes = [
    { value: 'all', label: t('contacts.partners.filters.all', { defaultValue: '–í—Å–µ –ø–∞—Ä—Ç–Ω–µ—Ä—ã' }), icon: 'üåê' },
    { value: 'clinical', label: t('contacts.partners.filters.clinical', { defaultValue: '–ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ' }), icon: 'üè•' },
    { value: 'university', label: t('contacts.partners.filters.university', { defaultValue: '–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—ã' }), icon: 'üéì' },
    { value: 'research', label: t('contacts.partners.filters.research', { defaultValue: '–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è' }), icon: 'üî¨' },
    { value: 'business', label: t('contacts.partners.filters.business', { defaultValue: '–ë–∏–∑–Ω–µ—Å' }), icon: 'üíº' }
  ];

  const filteredPartners = partners.filter(partner => {
    const matchesFilter = activeFilter === 'all' || partner.type === activeFilter;
    const matchesSearch = partner.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                         partner.city.toLowerCase().includes(searchQuery.toLowerCase()) ||
                         partner.description.toLowerCase().includes(searchQuery.toLowerCase());
    return matchesFilter && matchesSearch;
  });

  const openPartnerModal = (partner) => {
    setSelectedPartner(partner);
  };

  const openLocationModal = (location) => {
    setSelectedLocation(location);
  };

  const closeModal = () => {
    setSelectedPartner(null);
    setSelectedLocation(null);
  };

  const handleContactClick = (type, value) => {
    if (type === 'phone') {
      window.open(`tel:${value}`);
    } else if (type === 'email') {
      window.open(`mailto:${value}`);
    }
  };

  return (
    <section ref={ref} className="relative py-20 bg-gradient-to-br from-slate-50 via-white to-blue-50/30 overflow-hidden">
      {/* –£–ª—É—á—à–µ–Ω–Ω—ã–π –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω */}
      <div className="absolute inset-0 opacity-10">
        <motion.div
          variants={floatingVariants}
          animate="animate"
          className="absolute top-20 left-10 w-40 h-40 bg-gradient-to-r from-blue-300 to-cyan-300 rounded-full blur-3xl"
        />
        <motion.div
          variants={floatingVariants}
          animate="animate"
          transition={{ delay: 2 }}
          className="absolute bottom-20 right-10 w-48 h-48 bg-gradient-to-r from-green-300 to-emerald-300 rounded-full blur-3xl"
        />
        <motion.div
          variants={floatingVariants}
          animate="animate"
          transition={{ delay: 4 }}
          className="absolute top-1/2 left-1/4 w-32 h-32 bg-gradient-to-r from-purple-300 to-pink-300 rounded-full blur-3xl"
        />
      </div>

      {/* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–µ—Ç–∫–∏ */}
      <div className="absolute inset-0 opacity-[0.03]">
        <div className="absolute inset-0 bg-[linear-gradient(90deg,#000_1px,transparent_1px)] bg-[size:64px_64px]"></div>
        <div className="absolute inset-0 bg-[linear-gradient(0deg,#000_1px,transparent_1px)] bg-[size:64px_64px]"></div>
      </div>

      <div className="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏ */}
        <motion.div
          variants={containerVariants}
          initial="hidden"
          animate={isInView ? "visible" : "hidden"}
          className="text-center mb-16"
        >
          <motion.div 
            variants={itemVariants}
            className="inline-flex items-center px-4 py-2 rounded-full bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200/50 mb-6 shadow-sm"
          >
            <span className="text-blue-600 text-sm font-semibold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent">
              {t('contacts.badge')}
            </span>
          </motion.div>
          
          <motion.h2 
            variants={itemVariants}
            className="text-5xl md:text-6xl lg:text-7xl font-bold mb-8 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-700 bg-clip-text text-transparent"
          >
            {t('contacts.title')}{' '}
            <span className="bg-gradient-to-r from-blue-600 to-green-600 bg-clip-text text-transparent">
              {t('contacts.titleHighlight')}
            </span>
          </motion.h2>
          
          <motion.div
            variants={itemVariants}
            className="w-24 h-1 bg-gradient-to-r from-blue-500 via-cyan-500 to-green-500 rounded-full mx-auto mb-8 shadow-lg"
          />

          <motion.p 
            variants={itemVariants}
            className="text-xl text-slate-600 max-w-3xl mx-auto leading-relaxed font-light"
          >
            {t('contacts.subtitle')}
          </motion.p>
        </motion.div>

        <div className="grid lg:grid-cols-2 gap-8 lg:gap-12">
          {/* –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */}
          <motion.div
            variants={containerVariants}
            initial="hidden"
            animate={isInView ? "visible" : "hidden"}
            className="space-y-8"
          >
            {/* –ê–¥—Ä–µ—Å */}
            <motion.div
              variants={cardVariants}
              className="bg-white/90 backdrop-blur-sm rounded-3xl p-8 border border-slate-200/60 shadow-lg hover:shadow-2xl transition-all duration-500 group cursor-pointer"
              whileHover="hover"
              onMouseEnter={() => setActiveContact('address')}
              onMouseLeave={() => setActiveContact(null)}
              onClick={() => openLocationModal(mapLocations[0])}
            >
              <div className="flex items-start space-x-6">
                <motion.div 
                  className="flex-shrink-0 w-16 h-16 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-2xl flex items-center justify-center text-2xl text-white shadow-lg group-hover:shadow-xl transition-all duration-500"
                  whileHover={{ scale: 1.1, rotate: 5 }}
                >
                  {contactInfo.address.icon}
                </motion.div>
                <div className="flex-1">
                  <h3 className="text-2xl font-bold text-slate-900 mb-3 group-hover:text-blue-600 transition-colors duration-300">
                    {contactInfo.address.title}
                  </h3>
                  <p className="text-slate-700 text-lg leading-relaxed mb-4">
                    {contactInfo.address.value}
                  </p>
                  <p className="text-slate-600 mb-6">
                    {contactInfo.address.description}
                  </p>
                  
                  <div className="flex flex-wrap gap-3">
                    <motion.button
                      className="inline-flex items-center space-x-3 bg-blue-50 text-blue-600 px-6 py-3 rounded-xl font-semibold hover:bg-blue-100 transition-colors duration-300 border border-blue-200/60"
                      whileHover={{ scale: 1.05, x: 5 }}
                      whileTap={{ scale: 0.95 }}
                      onClick={(e) => {
                        e.stopPropagation();
                        copyToClipboard(contactInfo.address.value, 'address');
                      }}
                    >
                      <span>{copiedField === 'address' ? t('contacts.copied') : t('contacts.copyAddress')}</span>
                      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                      </svg>
                    </motion.button>

                    <motion.button
                      className="inline-flex items-center space-x-3 text-slate-600 hover:text-slate-800 font-medium transition-colors duration-300"
                      whileHover={{ x: 5 }}
                    >
                      <span>{t('contacts.viewOnMap', { defaultValue: '–ù–∞ –∫–∞—Ä—Ç–µ' })}</span>
                      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                      </svg>
                    </motion.button>
                  </div>
                </div>
              </div>
            </motion.div>

            {/* –¢–µ–ª–µ—Ñ–æ–Ω—ã */}
            <motion.div
              variants={cardVariants}
              className="bg-white/90 backdrop-blur-sm rounded-3xl p-8 border border-slate-200/60 shadow-lg hover:shadow-2xl transition-all duration-500"
            >
              <h3 className="text-2xl font-bold text-slate-900 mb-6 flex items-center">
                <span className="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center text-green-600 mr-3">üìû</span>
                {t('contacts.phones.title')}
              </h3>
              
              <div className="grid md:grid-cols-2 gap-6">
                {contactInfo.phones.map((phone, index) => (
                  <motion.div
                    key={index}
                    className="flex items-start space-x-4 p-4 rounded-2xl bg-slate-50/80 hover:bg-slate-100/80 transition-colors duration-300 group/phone cursor-pointer"
                    whileHover={{ scale: 1.02, y: -2 }}
                    onMouseEnter={() => setActiveContact(`phone-${index}`)}
                    onMouseLeave={() => setActiveContact(null)}
                    onClick={() => handleContactClick('phone', phone.number)}
                  >
                    <div className="flex-shrink-0 w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center text-lg group-hover/phone:bg-green-500 transition-colors duration-300 shadow-sm">
                      <span className="group-hover/phone:text-white transition-colors duration-300">
                        {phone.icon}
                      </span>
                    </div>
                    <div className="flex-1 min-w-0">
                      <h4 className="font-semibold text-slate-900 text-base mb-2">
                        {phone.title}
                      </h4>
                      <div className="flex items-center space-x-3 mb-2">
                        <a 
                          href={`tel:${phone.number}`}
                          className="text-slate-800 hover:text-green-600 transition-colors duration-300 text-lg font-semibold"
                        >
                          {phone.number}
                        </a>
                        <motion.button
                          className="text-slate-400 hover:text-green-600 transition-colors duration-300"
                          whileHover={{ scale: 1.1 }}
                          whileTap={{ scale: 0.9 }}
                          onClick={(e) => {
                            e.stopPropagation();
                            copyToClipboard(phone.number, `phone-${index}`);
                          }}
                        >
                          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                          </svg>
                        </motion.button>
                      </div>
                      <p className="text-slate-600 text-sm mb-1">
                        {phone.description}
                      </p>
                      <p className="text-slate-500 text-xs">
                        {phone.department}
                      </p>
                    </div>
                  </motion.div>
                ))}
              </div>
            </motion.div>

            {/* Email */}
            <motion.div
              variants={cardVariants}
              className="bg-white/90 backdrop-blur-sm rounded-3xl p-8 border border-slate-200/60 shadow-lg hover:shadow-2xl transition-all duration-500"
            >
              <h3 className="text-2xl font-bold text-slate-900 mb-6 flex items-center">
                <span className="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center text-purple-600 mr-3">üìß</span>
                {t('contacts.emails.title')}
              </h3>
              
              <div className="space-y-4">
                {contactInfo.emails.map((email, index) => (
                  <motion.div
                    key={index}
                    className="flex items-center justify-between p-4 rounded-2xl bg-slate-50/80 hover:bg-slate-100/80 transition-colors duration-300 group/email cursor-pointer"
                    whileHover={{ scale: 1.02, y: -2 }}
                    onMouseEnter={() => setActiveContact(`email-${index}`)}
                    onMouseLeave={() => setActiveContact(null)}
                    onClick={() => handleContactClick('email', email.address)}
                  >
                    <div className="flex items-center space-x-4">
                      <div className="flex-shrink-0 w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center text-lg group-hover/email:bg-purple-500 transition-colors duration-300 shadow-sm">
                        <span className="group-hover/email:text-white transition-colors duration-300">
                          {email.icon}
                        </span>
                      </div>
                      <div>
                        <h4 className="font-semibold text-slate-900 text-base mb-1">
                          {email.title}
                        </h4>
                        <a 
                          href={`mailto:${email.address}`}
                          className="text-slate-700 hover:text-purple-600 transition-colors duration-300 text-base"
                        >
                          {email.address}
                        </a>
                        <p className="text-slate-500 text-sm mt-1">
                          {email.response}
                        </p>
                      </div>
                    </div>
                    
                    <motion.button
                      className="text-slate-400 hover:text-purple-600 transition-colors duration-300 p-2 rounded-lg hover:bg-purple-50"
                      whileHover={{ scale: 1.1 }}
                      whileTap={{ scale: 0.9 }}
                      onClick={(e) => {
                        e.stopPropagation();
                        copyToClipboard(email.address, `email-${index}`);
                      }}
                    >
                      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                      </svg>
                    </motion.button>
                  </motion.div>
                ))}
              </div>
            </motion.div>

            {/* –ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã */}
            <motion.div
              variants={cardVariants}
              className="bg-white/90 backdrop-blur-sm rounded-3xl p-8 border border-slate-200/60 shadow-lg hover:shadow-2xl transition-all duration-500 group"
              whileHover={{ y: -5, scale: 1.02 }}
            >
              <div className="flex items-start space-x-6">
                <motion.div 
                  className="flex-shrink-0 w-16 h-16 bg-gradient-to-br from-orange-500 to-amber-500 rounded-2xl flex items-center justify-center text-2xl text-white shadow-lg group-hover:shadow-xl transition-all duration-500"
                  whileHover={{ scale: 1.1, rotate: 5 }}
                >
                  {contactInfo.hours.icon}
                </motion.div>
                <div className="flex-1">
                  <h3 className="text-2xl font-bold text-slate-900 mb-4">
                    {contactInfo.hours.title}
                  </h3>
                  
                  <div className="space-y-4">
                    {contactInfo.hours.schedule.map((schedule, index) => (
                      <div key={index} className="flex justify-between items-center py-3 border-b border-slate-100 last:border-b-0">
                        <div>
                          <span className="text-slate-800 font-semibold text-base block">
                            {schedule.days}
                          </span>
                          <span className="text-slate-500 text-sm">
                            {schedule.note}
                          </span>
                        </div>
                        <span className="text-slate-700 font-bold text-base bg-amber-50 px-3 py-1 rounded-lg">
                          {schedule.time}
                        </span>
                      </div>
                    ))}
                  </div>

                  <p className="text-slate-500 text-sm mt-4">
                    {contactInfo.hours.notice}
                  </p>
                </div>
              </div>
            </motion.div>

            {/* –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ */}
            <motion.div
              variants={cardVariants}
              className="bg-white/90 backdrop-blur-sm rounded-3xl p-8 border border-slate-200/60 shadow-lg hover:shadow-2xl transition-all duration-500"
            >
              <h3 className="text-2xl font-bold text-slate-900 mb-6">
                {contactInfo.social.title}
              </h3>
              
              <div className="grid grid-cols-2 sm:grid-cols-4 gap-4">
                {contactInfo.social.platforms.map((platform, index) => (
                  <motion.a
                    key={index}
                    href={platform.url}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="flex flex-col items-center p-4 rounded-2xl bg-slate-50/80 hover:bg-blue-50 transition-all duration-300 group/social text-center"
                    whileHover={{ scale: 1.05, y: -2 }}
                    whileTap={{ scale: 0.95 }}
                  >
                    <div className="text-3xl mb-2 group-hover/social:scale-110 transition-transform duration-300">
                      {platform.icon}
                    </div>
                    <div className="text-slate-700 font-semibold text-sm mb-1">
                      {platform.name}
                    </div>
                    <div className="text-slate-500 text-xs">
                      {platform.handle}
                    </div>
                  </motion.a>
                ))}
              </div>
            </motion.div>
          </motion.div>

          {/* –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –ö–∞—Ä—Ç–∞ */}
          <motion.div
            variants={containerVariants}
            initial="hidden"
            animate={isInView ? "visible" : "hidden"}
            className="space-y-8"
          >
            {/* –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –∫–∞—Ä—Ç–∞–º–∏ –∏ —Ñ–∏–ª—å—Ç—Ä—ã */}
            <motion.div
              variants={cardVariants}
              className="bg-white/90 backdrop-blur-sm rounded-3xl p-6 border border-slate-200/60 shadow-lg"
            >
              <div className="flex flex-col sm:flex-row gap-4 mb-4">
                <div className="flex space-x-2 flex-1">
                  <button
                    onClick={() => setMapType('locations')}
                    className={`flex-1 px-6 py-3 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center space-x-3 ${
                      mapType === 'locations'
                        ? 'bg-gradient-to-r from-blue-600 to-cyan-600 text-white shadow-lg shadow-blue-500/25'
                        : 'bg-slate-100 text-slate-600 hover:bg-slate-200'
                    }`}
                  >
                    <span>üìç</span>
                    <span>{t('contacts.map.tabs.locations', { defaultValue: '–ù–∞—à–∏ –ª–æ–∫–∞—Ü–∏–∏' })}</span>
                  </button>
                  <button
                    onClick={() => setMapType('partners')}
                    className={`flex-1 px-6 py-3 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center space-x-3 ${
                      mapType === 'partners'
                        ? 'bg-gradient-to-r from-green-600 to-emerald-600 text-white shadow-lg shadow-green-500/25'
                        : 'bg-slate-100 text-slate-600 hover:bg-slate-200'
                    }`}
                  >
                    <span>ü§ù</span>
                    <span>{t('contacts.map.tabs.partners', { defaultValue: '–ü–∞—Ä—Ç–Ω–µ—Ä—ã' })}</span>
                  </button>
                </div>
              </div>

              {/* –§–∏–ª—å—Ç—Ä—ã –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ */}
              {mapType === 'partners' && (
                <div className="space-y-4">
                  <div className="flex flex-wrap gap-2">
                    {partnerTypes.map((type) => (
                      <motion.button
                        key={type.value}
                        onClick={() => setActiveFilter(type.value)}
                        className={`px-4 py-2 rounded-lg font-medium transition-all duration-300 flex items-center space-x-2 ${
                          activeFilter === type.value
                            ? 'bg-blue-100 text-blue-700 border border-blue-200 shadow-sm'
                            : 'bg-slate-100 text-slate-600 hover:bg-slate-200'
                        }`}
                        whileHover={{ scale: 1.05 }}
                        whileTap={{ scale: 0.95 }}
                      >
                        <span>{type.icon}</span>
                        <span className="text-sm">{type.label}</span>
                      </motion.button>
                    ))}
                  </div>

                  {/* –ü–æ–∏—Å–∫ */}
                  <div className="relative">
                    <input
                      type="text"
                      placeholder={t('contacts.partners.search.placeholder', { defaultValue: '–ü–æ–∏—Å–∫ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤...' })}
                      value={searchQuery}
                      onChange={(e) => setSearchQuery(e.target.value)}
                      className="w-full px-4 py-3 pl-12 rounded-xl border border-slate-200 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                    />
                    <div className="absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400">
                      üîç
                    </div>
                    {searchQuery && (
                      <button
                        onClick={() => setSearchQuery('')}
                        className="absolute right-4 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors duration-300"
                      >
                        ‚úï
                      </button>
                    )}
                  </div>
                </div>
              )}
            </motion.div>

            {/* –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ */}
            <motion.div
              variants={cardVariants}
              className="bg-white/90 backdrop-blur-sm rounded-3xl p-6 border border-slate-200/60 shadow-lg hover:shadow-2xl transition-all duration-500"
            >
              <h3 className="text-2xl font-bold text-slate-900 mb-6">
                {mapType === 'locations' 
                  ? t('contacts.map.title') 
                  : t('contacts.map.partnersTitle', { defaultValue: '–ü–∞—Ä—Ç–Ω–µ—Ä—ã –Ω–∞ –∫–∞—Ä—Ç–µ' })
                }
              </h3>
              
              <div className="relative bg-white rounded-2xl overflow-hidden border border-slate-200 min-h-[500px] shadow-inner">
                {loading ? (
                  <div className="absolute inset-0 flex items-center justify-center bg-slate-50/80 backdrop-blur-sm z-10">
                    <div className="text-center">
                      <motion.div
                        animate={{ rotate: 360 }}
                        transition={{ duration: 1, repeat: Infinity, ease: "linear" }}
                        className="w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"
                      />
                      <p className="text-slate-600 font-medium">
                        {t('contacts.map.loading', { defaultValue: '–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç—ã...' })}
                      </p>
                    </div>
                  </div>
                ) : error ? (
                  <div className="absolute inset-0 flex items-center justify-center bg-slate-50/80 backdrop-blur-sm z-10">
                    <div className="text-center">
                      <div className="text-4xl mb-4">‚ö†Ô∏è</div>
                      <p className="text-slate-600 font-medium mb-4">{error}</p>
                      <button 
                        onClick={() => window.location.reload()}
                        className="bg-blue-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors duration-300"
                      >
                        {t('contacts.map.retry', { defaultValue: '–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞' })}
                      </button>
                    </div>
                  </div>
                ) : (
                  <MapContainer
                    center={mapType === 'locations' ? [42.8746, 74.5698] : [42.8746, 74.5698]}
                    zoom={mapType === 'locations' ? 12 : 10}
                    style={{ height: '500px', width: '100%' }}
                    className="z-0 rounded-xl"
                  >
                    <TileLayer
                      attribution='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                      url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
                    />

                    {/* –ù–∞—à–∏ –ª–æ–∫–∞—Ü–∏–∏ */}
                    {mapType === 'locations' && mapLocations.map((location) => (
                      <Marker
                        key={location.id}
                        position={location.coordinates}
                        icon={createLocationMarker(location.type)}
                        eventHandlers={{
                          click: () => openLocationModal(location),
                        }}
                      >
                        <Popup className="custom-popup">
                          <div className="p-4 min-w-[280px]">
                            <h4 className="font-bold text-slate-900 text-lg mb-2">
                              {location.title}
                            </h4>
                            <p className="text-slate-600 text-sm mb-3">
                              {location.description}
                            </p>
                            <div className="space-y-2 mb-4">
                              <div className="text-xs font-semibold text-slate-700">
                                {t('contacts.map.amenities', { defaultValue: '–£–¥–æ–±—Å—Ç–≤–∞' })}:
                              </div>
                              <div className="flex flex-wrap gap-1">
                                {location.amenities.map((amenity, index) => (
                                  <span
                                    key={index}
                                    className="px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full"
                                  >
                                    {amenity}
                                  </span>
                                ))}
                              </div>
                            </div>
                            <div className="flex space-x-2">
                              <button
                                onClick={() => window.open(`https://maps.google.com/?q=${location.coordinates[0]},${location.coordinates[1]}`, '_blank')}
                                className="flex-1 bg-blue-600 text-white px-3 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors duration-300"
                              >
                                {t('contacts.map.buttons.directions')}
                              </button>
                              <button
                                onClick={() => openLocationModal(location)}
                                className="flex-1 border border-slate-300 text-slate-700 px-3 py-2 rounded-lg text-sm font-medium hover:bg-slate-50 transition-colors duration-300"
                              >
                                {t('contacts.map.buttons.details', { defaultValue: '–ü–æ–¥—Ä–æ–±–Ω–µ–µ' })}
                              </button>
                            </div>
                          </div>
                        </Popup>
                      </Marker>
                    ))}

                    {/* –ü–∞—Ä—Ç–Ω–µ—Ä—ã */}
                    {mapType === 'partners' && filteredPartners.map((partner) => (
                      <Marker
                        key={partner.id}
                        position={partner.coordinates}
                        icon={createCustomMarker(partner.type)}
                        eventHandlers={{
                          click: () => openPartnerModal(partner),
                        }}
                      >
                        <Popup className="custom-popup">
                          <div className="p-4 min-w-[300px]">
                            <div className="flex items-start mb-3">
                              <div className="w-12 h-12 bg-slate-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0">
                                <span className="text-2xl">
                                  {partner.type === 'clinical' ? 'üè•' :
                                   partner.type === 'university' ? 'üéì' :
                                   partner.type === 'research' ? 'üî¨' : 'üíº'}
                                </span>
                              </div>
                              <div className="flex-1 min-w-0">
                                <h3 className="font-bold text-gray-900 text-base mb-1">
                                  {partner.name}
                                </h3>
                                <span className={`px-2 py-1 rounded-full text-xs font-medium ${getTypeBadgeColor(partner.type)} border`}>
                                  {getTypeLabel(partner.type)}
                                </span>
                              </div>
                            </div>

                            <div className="flex items-center text-sm text-gray-600 mb-3">
                              <span className="mr-2">üìç</span>
                              <span>{partner.city}, {partner.country}</span>
                            </div>

                            <p className="text-gray-600 text-sm mb-4 line-clamp-2">
                              {partner.description}
                            </p>

                            {partner.cooperation && partner.cooperation.length > 0 && (
                              <div className="mb-4">
                                <div className="text-xs font-semibold text-gray-900 mb-2">
                                  {t('contacts.partners.cooperation', { defaultValue: '–°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ' })}:
                                </div>
                                <div className="flex flex-wrap gap-1">
                                  {partner.cooperation.slice(0, 3).map((area, index) => (
                                    <span
                                      key={index}
                                      className="px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full"
                                    >
                                      {area}
                                    </span>
                                  ))}
                                  {partner.cooperation.length > 3 && (
                                    <span className="text-xs text-gray-500 px-2 py-1">
                                      +{partner.cooperation.length - 3}
                                    </span>
                                  )}
                                </div>
                              </div>
                            )}

                            <div className="flex space-x-2">
                              {partner.website && (
                                <a
                                  href={partner.website}
                                  target="_blank"
                                  rel="noopener noreferrer"
                                  className="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition-colors duration-300 text-center"
                                >
                                  {t('contacts.partners.website', { defaultValue: '–°–∞–π—Ç' })}
                                </a>
                              )}
                              <button
                                onClick={() => openPartnerModal(partner)}
                                className="flex-1 border border-slate-300 text-slate-700 px-3 py-2 rounded-lg text-sm font-medium hover:bg-slate-50 transition-colors duration-300"
                              >
                                {t('contacts.partners.viewDetails', { defaultValue: '–ü–æ–¥—Ä–æ–±–Ω–µ–µ' })}
                              </button>
                            </div>
                          </div>
                        </Popup>
                      </Marker>
                    ))}
                  </MapContainer>
                )}

                {/* –õ–µ–≥–µ–Ω–¥–∞ –∫–∞—Ä—Ç—ã */}
                <div className="absolute bottom-6 left-6 bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl border border-slate-200 p-4 max-w-xs">
                  <h4 className="text-sm font-semibold text-slate-900 mb-3 flex items-center">
                    <span className="mr-2">üó∫Ô∏è</span>
                    {t('contacts.map.legend', { defaultValue: '–õ–µ–≥–µ–Ω–¥–∞' })}
                  </h4>
                  <div className="space-y-3">
                    {mapType === 'locations' ? (
                      <>
                        {mapLocations.map((location) => (
                          <div key={location.id} className="flex items-center space-x-3 text-sm">
                            <div 
                              className="w-4 h-4 rounded-full border-2 border-white shadow-sm"
                              style={{
                                backgroundColor: 
                                  location.type === 'office' ? '#dc2626' :
                                  location.type === 'storage' ? '#059669' : '#7c3aed'
                              }}
                            ></div>
                            <span className="text-slate-700 flex-1">{location.title}</span>
                          </div>
                        ))}
                      </>
                    ) : (
                      <>
                        {partnerTypes.slice(1).map((type) => (
                          <div key={type.value} className="flex items-center space-x-3 text-sm">
                            <div
                              className="w-4 h-4 rounded-full border-2 border-white shadow-sm"
                              style={{
                                backgroundColor: 
                                  type.value === 'clinical' ? '#dc2626' :
                                  type.value === 'university' ? '#2563eb' :
                                  type.value === 'research' ? '#16a34a' :
                                  type.value === 'business' ? '#9333ea' : '#6b7280'
                              }}
                            ></div>
                            <span className="text-slate-700 flex-1">{type.label}</span>
                          </div>
                        ))}
                      </>
                    )}
                  </div>
                </div>
              </div>

              {/* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥ –∫–∞—Ä—Ç–æ–π */}
              <div className="mt-6 grid grid-cols-2 lg:grid-cols-4 gap-4">
                <div className="text-center p-4 bg-blue-50 rounded-xl border border-blue-200">
                  <div className="text-2xl font-bold text-blue-600 mb-1">
                    {mapType === 'locations' ? mapLocations.length : filteredPartners.length}
                  </div>
                  <div className="text-sm text-blue-700 font-medium">
                    {mapType === 'locations' 
                      ? t('contacts.map.stats.locations', { defaultValue: '–õ–æ–∫–∞—Ü–∏–∏' })
                      : t('contacts.map.stats.partners', { defaultValue: '–ü–∞—Ä—Ç–Ω–µ—Ä–æ–≤' })
                    }
                  </div>
                </div>
                <div className="text-center p-4 bg-green-50 rounded-xl border border-green-200">
                  <div className="text-2xl font-bold text-green-600 mb-1">
                    {mapType === 'locations' ? '3' : partnerTypes.length - 1}
                  </div>
                  <div className="text-sm text-green-700 font-medium">
                    {mapType === 'locations'
                      ? t('contacts.map.stats.types', { defaultValue: '–¢–∏–ø–∞ –æ–±—ä–µ–∫—Ç–æ–≤' })
                      : t('contacts.map.stats.categories', { defaultValue: '–ö–∞—Ç–µ–≥–æ—Ä–∏–∏' })
                    }
                  </div>
                </div>
                <div className="text-center p-4 bg-purple-50 rounded-xl border border-purple-200">
                  <div className="text-2xl font-bold text-purple-600 mb-1">
                    {mapType === 'locations' ? '24/7' : '15+'}
                  </div>
                  <div className="text-sm text-purple-700 font-medium">
                    {mapType === 'locations'
                      ? t('contacts.map.stats.availability', { defaultValue: '–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å' })
                      : t('contacts.map.stats.experience', { defaultValue: '–õ–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞' })
                    }
                  </div>
                </div>
                <div className="text-center p-4 bg-amber-50 rounded-xl border border-amber-200">
                  <div className="text-2xl font-bold text-amber-600 mb-1">
                    {mapType === 'locations' ? '100%' : '98%'}
                  </div>
                  <div className="text-sm text-amber-700 font-medium">
                    {mapType === 'locations'
                      ? t('contacts.map.stats.coverage', { defaultValue: '–û—Ö–≤–∞—Ç' })
                      : t('contacts.map.stats.satisfaction', { defaultValue: '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å' })
                    }
                  </div>
                </div>
              </div>
            </motion.div>

            {/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */}
            <motion.div
              variants={cardVariants}
              className="bg-gradient-to-r from-blue-50 to-cyan-50 rounded-3xl p-8 border border-blue-200/60 shadow-lg"
            >
              <h3 className="text-2xl font-bold text-slate-900 mb-6">
                {t('contacts.additionalInfo.title')}
              </h3>
              
              <div className="space-y-6">
                <div className="flex items-start space-x-4">
                  <div className="flex-shrink-0 w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center shadow-lg">
                    <span className="text-white text-xl">üöó</span>
                  </div>
                  <div>
                    <h4 className="font-semibold text-slate-900 text-lg mb-2">
                      {t('contacts.additionalInfo.parking.title')}
                    </h4>
                    <p className="text-slate-600">
                      {t('contacts.additionalInfo.parking.description')}
                    </p>
                    <div className="flex flex-wrap gap-2 mt-3">
                      <span className="px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-full">
                        {t('contacts.additionalInfo.parking.tags.0', { defaultValue: '–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è' })}
                      </span>
                      <span className="px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-full">
                        {t('contacts.additionalInfo.parking.tags.1', { defaultValue: '–û—Ö—Ä–∞–Ω—è–µ–º–∞—è' })}
                      </span>
                      <span className="px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-full">
                        {t('contacts.additionalInfo.parking.tags.2', { defaultValue: '200+ –º–µ—Å—Ç' })}
                      </span>
                    </div>
                  </div>
                </div>

                <div className="flex items-start space-x-4">
                  <div className="flex-shrink-0 w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center shadow-lg">
                    <span className="text-white text-xl">üöå</span>
                  </div>
                  <div>
                    <h4 className="font-semibold text-slate-900 text-lg mb-2">
                      {t('contacts.additionalInfo.transport.title')}
                    </h4>
                    <p className="text-slate-600">
                      {t('contacts.additionalInfo.transport.description')}
                    </p>
                    <div className="grid grid-cols-2 gap-2 mt-3">
                      <div className="flex items-center text-sm text-slate-600">
                        <span className="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                        {t('contacts.additionalInfo.transport.routes.0', { defaultValue: '–ê–≤—Ç–æ–±—É—Å ‚Ññ5' })}
                      </div>
                      <div className="flex items-center text-sm text-slate-600">
                        <span className="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                        {t('contacts.additionalInfo.transport.routes.1', { defaultValue: '–ê–≤—Ç–æ–±—É—Å ‚Ññ12' })}
                      </div>
                      <div className="flex items-center text-sm text-slate-600">
                        <span className="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                        {t('contacts.additionalInfo.transport.routes.2', { defaultValue: '–ê–≤—Ç–æ–±—É—Å ‚Ññ25' })}
                      </div>
                      <div className="flex items-center text-sm text-slate-600">
                        <span className="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                        {t('contacts.additionalInfo.transport.routes.3', { defaultValue: '–ê–≤—Ç–æ–±—É—Å ‚Ññ35' })}
                      </div>
                    </div>
                  </div>
                </div>

                <div className="flex items-start space-x-4">
                  <div className="flex-shrink-0 w-12 h-12 bg-purple-500 rounded-xl flex items-center justify-center shadow-lg">
                    <span className="text-white text-xl">‚ôø</span>
                  </div>
                  <div>
                    <h4 className="font-semibold text-slate-900 text-lg mb-2">
                      {t('contacts.additionalInfo.accessibility.title')}
                    </h4>
                    <p className="text-slate-600">
                      {t('contacts.additionalInfo.accessibility.description')}
                    </p>
                    <div className="flex flex-wrap gap-2 mt-3">
                      <span className="px-3 py-1 bg-purple-100 text-purple-700 text-sm rounded-full">
                        {t('contacts.additionalInfo.accessibility.features.0', { defaultValue: '–ü–∞–Ω–¥—É—Å—ã' })}
                      </span>
                      <span className="px-3 py-1 bg-purple-100 text-purple-700 text-sm rounded-full">
                        {t('contacts.additionalInfo.accessibility.features.1', { defaultValue: '–õ–∏—Ñ—Ç—ã' })}
                      </span>
                      <span className="px-3 py-1 bg-purple-100 text-purple-700 text-sm rounded-full">
                        {t('contacts.additionalInfo.accessibility.features.2', { defaultValue: '–°–ø–µ—Ü–ø–∞—Ä–∫–æ–≤–∫–∏' })}
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </motion.div>
          </motion.div>
        </div>

        {/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ */}
        <AnimatePresence>
          {selectedPartner && (
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
              className="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4"
              onClick={closeModal}
            >
              <motion.div
                initial={{ scale: 0.9, opacity: 0, y: 50 }}
                animate={{ scale: 1, opacity: 1, y: 0 }}
                exit={{ scale: 0.9, opacity: 0, y: 50 }}
                transition={{ type: "spring", damping: 25 }}
                className="bg-white rounded-3xl max-w-4xl w-full max-h-[90vh] overflow-y-auto"
                onClick={(e) => e.stopPropagation()}
              >
                <div className="relative p-8">
                  <button
                    onClick={closeModal}
                    className="absolute top-6 right-6 w-10 h-10 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition-colors duration-300 group"
                  >
                    <svg className="w-5 h-5 text-slate-600 group-hover:text-slate-800" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                    </svg>
                  </button>

                  <div className="flex items-start mb-6">
                    <div className="w-20 h-20 bg-slate-100 rounded-2xl flex items-center justify-center mr-6 flex-shrink-0 shadow-lg">
                      <span className="text-4xl">
                        {selectedPartner.type === 'clinical' ? 'üè•' :
                         selectedPartner.type === 'university' ? 'üéì' :
                         selectedPartner.type === 'research' ? 'üî¨' : 'üíº'}
                      </span>
                    </div>
                    <div className="flex-1">
                      <h3 className="text-3xl font-bold text-slate-900 mb-2">{selectedPartner.name}</h3>
                      <div className="flex flex-wrap items-center gap-3 mb-4">
                        <span className={`px-3 py-1 rounded-full text-sm font-medium ${getTypeBadgeColor(selectedPartner.type)} border`}>
                          {getTypeLabel(selectedPartner.type)}
                        </span>
                        <span className="px-3 py-1 bg-slate-100 text-slate-700 rounded-full text-sm font-medium">
                          {selectedPartner.city}, {selectedPartner.country}
                        </span>
                        {selectedPartner.established && (
                          <span className="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium">
                            {t('contacts.partners.established', { defaultValue: '–û—Å–Ω–æ–≤–∞–Ω' })}: {selectedPartner.established}
                          </span>
                        )}
                      </div>
                    </div>
                  </div>

                  <div className="prose prose-slate max-w-none mb-8">
                    <p className="text-lg text-slate-700 leading-relaxed">
                      {selectedPartner.description}
                    </p>
                  </div>

                  <div className="grid md:grid-cols-2 gap-8 mb-8">
                    <div>
                      <h4 className="text-lg font-semibold text-slate-900 mb-4">
                        {t('contacts.partners.contactInfo', { defaultValue: '–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è' })}
                      </h4>
                      <div className="space-y-4">
                        {selectedPartner.contact.email && (
                          <div className="flex items-center">
                            <div className="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 mr-3">
                              üìß
                            </div>
                            <div>
                              <div className="text-sm text-slate-500">{t('contacts.partners.email', { defaultValue: 'Email' })}</div>
                              <a href={`mailto:${selectedPartner.contact.email}`} className="text-slate-700 hover:text-blue-600 font-medium">
                                {selectedPartner.contact.email}
                              </a>
                            </div>
                          </div>
                        )}
                        {selectedPartner.contact.phone && (
                          <div className="flex items-center">
                            <div className="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center text-green-600 mr-3">
                              üìû
                            </div>
                            <div>
                              <div className="text-sm text-slate-500">{t('contacts.partners.phone', { defaultValue: '–¢–µ–ª–µ—Ñ–æ–Ω' })}</div>
                              <a href={`tel:${selectedPartner.contact.phone}`} className="text-slate-700 hover:text-green-600 font-medium">
                                {selectedPartner.contact.phone}
                              </a>
                            </div>
                          </div>
                        )}
                        {selectedPartner.address && (
                          <div className="flex items-center">
                            <div className="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center text-purple-600 mr-3">
                              üìç
                            </div>
                            <div>
                              <div className="text-sm text-slate-500">{t('contacts.partners.address', { defaultValue: '–ê–¥—Ä–µ—Å' })}</div>
                              <div className="text-slate-700 font-medium">{selectedPartner.address}</div>
                            </div>
                          </div>
                        )}
                      </div>
                    </div>

                    <div>
                      <h4 className="text-lg font-semibold text-slate-900 mb-4">
                        {t('contacts.partners.cooperation', { defaultValue: '–°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ' })}
                      </h4>
                      {selectedPartner.cooperation && selectedPartner.cooperation.length > 0 && (
                        <div className="space-y-2">
                          {selectedPartner.cooperation.map((area, index) => (
                            <div key={index} className="flex items-center text-slate-600">
                              <span className="w-2 h-2 bg-blue-500 rounded-full mr-3"></span>
                              {area}
                            </div>
                          ))}
                        </div>
                      )}
                      {selectedPartner.cooperation_since && (
                        <div className="mt-4 p-4 bg-blue-50 rounded-xl border border-blue-200">
                          <div className="text-sm text-blue-700">
                            {t('contacts.partners.cooperationSince', { defaultValue: '–°–æ—Ç—Ä—É–¥–Ω–∏—á–∞–µ–º —Å' })} {selectedPartner.cooperation_since}
                          </div>
                        </div>
                      )}
                    </div>
                  </div>

                  <div className="flex flex-col sm:flex-row gap-4">
                    {selectedPartner.website && (
                      <motion.a
                        href={selectedPartner.website}
                        target="_blank"
                        rel="noopener noreferrer"
                        className="flex-1 bg-gradient-to-r from-blue-600 to-cyan-600 text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 text-center"
                        whileHover={{ scale: 1.02 }}
                        whileTap={{ scale: 0.98 }}
                      >
                        {t('contacts.partners.visitWebsite', { defaultValue: '–ü–æ—Å–µ—Ç–∏—Ç—å —Å–∞–π—Ç' })}
                      </motion.a>
                    )}
                    <motion.button
                      className="flex-1 border-2 border-slate-300 text-slate-700 px-6 py-3 rounded-xl font-semibold hover:border-blue-600 hover:text-blue-600 transition-all duration-300"
                      whileHover={{ scale: 1.02 }}
                      whileTap={{ scale: 0.98 }}
                      onClick={() => {
                        const message = t('contacts.partners.shareMessage', { 
                          defaultValue: '–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –Ω–∞—à–µ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞: {name}' 
                        }).replace('{name}', selectedPartner.name);
                        navigator.share?.({
                          title: selectedPartner.name,
                          text: message,
                          url: selectedPartner.website || window.location.href
                        }).catch(() => {
                          copyToClipboard(selectedPartner.website || window.location.href, 'share');
                        });
                      }}
                    >
                      {t('contacts.partners.share', { defaultValue: '–ü–æ–¥–µ–ª–∏—Ç—å—Å—è' })}
                    </motion.button>
                  </div>
                </div>
              </motion.div>
            </motion.div>
          )}
        </AnimatePresence>

        {/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ª–æ–∫–∞—Ü–∏–∏ */}
        <AnimatePresence>
          {selectedLocation && (
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
              className="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4"
              onClick={closeModal}
            >
              <motion.div
                initial={{ scale: 0.9, opacity: 0, y: 50 }}
                animate={{ scale: 1, opacity: 1, y: 0 }}
                exit={{ scale: 0.9, opacity: 0, y: 50 }}
                transition={{ type: "spring", damping: 25 }}
                className="bg-white rounded-3xl max-w-4xl w-full max-h-[90vh] overflow-y-auto"
                onClick={(e) => e.stopPropagation()}
              >
                <div className="relative p-8">
                  <button
                    onClick={closeModal}
                    className="absolute top-6 right-6 w-10 h-10 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition-colors duration-300 group"
                  >
                    <svg className="w-5 h-5 text-slate-600 group-hover:text-slate-800" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                    </svg>
                  </button>

                  <div className="flex items-start mb-6">
                    <div className="w-20 h-20 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-2xl flex items-center justify-center mr-6 flex-shrink-0 shadow-lg">
                      <span className="text-4xl text-white">
                        {selectedLocation.type === 'office' ? 'üè¢' :
                         selectedLocation.type === 'storage' ? 'üè≠' : 'üè™'}
                      </span>
                    </div>
                    <div className="flex-1">
                      <h3 className="text-3xl font-bold text-slate-900 mb-2">{selectedLocation.title}</h3>
                      <p className="text-slate-600 text-lg">{selectedLocation.description}</p>
                    </div>
                  </div>

                  <div className="prose prose-slate max-w-none mb-8">
                    <p className="text-lg text-slate-700 leading-relaxed">
                      {selectedLocation.details}
                    </p>
                  </div>

                  <div className="grid md:grid-cols-2 gap-8 mb-8">
                    <div>
                      <h4 className="text-lg font-semibold text-slate-900 mb-4">
                        {t('contacts.map.amenities', { defaultValue: '–£–¥–æ–±—Å—Ç–≤–∞' })}
                      </h4>
                      <div className="space-y-3">
                        {selectedLocation.amenities.map((amenity, index) => (
                          <div key={index} className="flex items-center text-slate-600">
                            <span className="w-2 h-2 bg-green-500 rounded-full mr-3"></span>
                            {amenity}
                          </div>
                        ))}
                      </div>
                    </div>

                    <div>
                      <h4 className="text-lg font-semibold text-slate-900 mb-4">
                        {t('contacts.map.locationDetails', { defaultValue: '–î–µ—Ç–∞–ª–∏ –ª–æ–∫–∞—Ü–∏–∏' })}
                      </h4>
                      <div className="space-y-3">
                        <div className="flex justify-between">
                          <span className="text-slate-600">{t('contacts.map.coordinates', { defaultValue: '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã' })}:</span>
                          <span className="font-medium">{selectedLocation.coordinates[0].toFixed(4)}, {selectedLocation.coordinates[1].toFixed(4)}</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-slate-600">{t('contacts.map.type', { defaultValue: '–¢–∏–ø –æ–±—ä–µ–∫—Ç–∞' })}:</span>
                          <span className="font-medium">
                            {selectedLocation.type === 'office' ? t('contacts.map.types.office', { defaultValue: '–û—Ñ–∏—Å' }) :
                             selectedLocation.type === 'storage' ? t('contacts.map.types.warehouse', { defaultValue: '–°–∫–ª–∞–¥' }) :
                             t('contacts.map.types.commercial', { defaultValue: '–¢–æ—Ä–≥–æ–≤—ã–π –∫–æ–º–ø–ª–µ–∫—Å' })}
                          </span>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div className="flex flex-col sm:flex-row gap-4">
                    <motion.button
                      className="flex-1 bg-gradient-to-r from-blue-600 to-cyan-600 text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all duration-300"
                      whileHover={{ scale: 1.02 }}
                      whileTap={{ scale: 0.98 }}
                      onClick={() => window.open(`https://maps.google.com/?q=${selectedLocation.coordinates[0]},${selectedLocation.coordinates[1]}`, '_blank')}
                    >
                      {t('contacts.map.buttons.getDirections', { defaultValue: '–ü—Ä–æ–ª–æ–∂–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç' })}
                    </motion.button>
                    <motion.button
                      className="flex-1 border-2 border-slate-300 text-slate-700 px-6 py-3 rounded-xl font-semibold hover:border-blue-600 hover:text-blue-600 transition-all duration-300"
                      whileHover={{ scale: 1.02 }}
                      whileTap={{ scale: 0.98 }}
                      onClick={() => {
                        const message = t('contacts.map.shareLocation', { 
                          defaultValue: '–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞—à—É –ª–æ–∫–∞—Ü–∏—é: {name} –ø–æ –∞–¥—Ä–µ—Å—É: {address}' 
                        }).replace('{name}', selectedLocation.title).replace('{address}', contactInfo.address.value);
                        navigator.share?.({
                          title: selectedLocation.title,
                          text: message,
                          url: window.location.href
                        }).catch(() => {
                          copyToClipboard(`${selectedLocation.title} - ${contactInfo.address.value}`, 'location');
                        });
                      }}
                    >
                      {t('contacts.map.buttons.share', { defaultValue: '–ü–æ–¥–µ–ª–∏—Ç—å—Å—è' })}
                    </motion.button>
                  </div>
                </div>
              </motion.div>
            </motion.div>
          )}
        </AnimatePresence>

        {/* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ */}
        <AnimatePresence>
          {copiedField && (
            <motion.div
              initial={{ opacity: 0, y: 50, scale: 0.8 }}
              animate={{ opacity: 1, y: 0, scale: 1 }}
              exit={{ opacity: 0, y: 50, scale: 0.8 }}
              className="fixed bottom-6 left-1/2 transform -translate-x-1/2 bg-green-500 text-white px-6 py-3 rounded-xl shadow-2xl z-50 flex items-center space-x-3"
            >
              <motion.div
                initial={{ scale: 0 }}
                animate={{ scale: 1 }}
                className="w-6 h-6 bg-white rounded-full flex items-center justify-center"
              >
                <svg className="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                </svg>
              </motion.div>
              <span className="font-semibold">{t('contacts.copiedNotification')}</span>
            </motion.div>
          )}
        </AnimatePresence>
      </div>
    </section>
  );
};

export default ContactsAddress;